{%- if generated == True -%}
{%- set name = "gen" -%}
# DO NOT EDIT THIS FILE MANUALLY
# This file is generated using peaks/ra/fsp/src/bsp/mcu/all/.xml_tests/generate_mcu_availability_tests.py
# If a module is missing from the list below then you can either update the script above or create a different
# YML file next to this one.
{%- else -%}
{%- set name = "manual" -%}
# This file is meant to be manually modified and is an extension of gen_ip_availability. The gen_ip_availability.yml file
# is generated and should not be modified manually. This file is meant to check for module availability for modules
# that are not present in the automatically generated file.
{%- endif %}

- name: {{ mcu }}_{{ name }}_ip_availability_test
  fsp_version: default
  board_or_device: {{ mcu_pn }}
  toolchain: gcc
  toolchain_version: default
  rtos: No RTOS
  template: Bare Metal - Minimal
  sequence:

    - op: get_hal
      name: t0

    # Generate and build to make sure defaults work for this MCU.
    - op: generate
    - op: build
      completed: 1

    # Delete default added ioport module so we can test adding it later
    - op: get_stack
      thread: t0
      id: module.driver.ioport_on_ioport
      name: ioport

    # Delete a top of stack
    - op: delete_stack
      name: ioport
      thread: t0

    # These <module>s can be added
{% for id in good_ids %}
    - op: check_if_module_can_be_added
      thread: t0
      id: {{ id }}
      success: yes
{% endfor %}

    # These <module>s cannot be added
    # Modules may not be added due to IP not being available on MCU or because the <module> has
    # the "visible" attribute set to "false". If the visible attribute is set to false then
    # the <module> may be available but it cannot be added by the user. It will be added
    # automatically as needed by the tooling.
{% for id in bad_ids %}
    - op: check_if_module_can_be_added
      thread: t0
      id: {{ id }}
      success: no
{% endfor %}
